package wtf.l4j.impl.modules.exploit;

import net.minecraft.entity.vehicle.BoatEntity;
import net.minecraft.network.packet.c2s.play.VehicleMoveC2SPacket;
import net.minecraft.util.math.Vec3d;

import wtf.l4j.api.module.Category;
import wtf.l4j.api.module.Module;
import wtf.l4j.api.module.ModuleInfo;

@ModuleInfo(name = "BoatExecute", desc = "When in a boat with someone both you and the other player die", category = Category.EXPLOIT)
public class BoatExecute extends Module {

    @Override
    public void onEnable() {
        if(!(mc.player.getVehicle() instanceof BoatEntity boat)){
            errorMessage("You Have to be in a boat");
            toggle();
            return;
        }
        Vec3d originalPos = boat.getPos();
        boat.setPosition(originalPos.add(0, 0.05, 0));
        VehicleMoveC2SPacket groundPacket = new VehicleMoveC2SPacket(boat);
        boat.setPosition(originalPos.add(0, 20, 0));
        VehicleMoveC2SPacket skyPacket = new VehicleMoveC2SPacket(boat);
        boat.setPosition(originalPos);
        for (int i = 0; i < 20; i++){
            sendPacket(skyPacket);
            sendPacket(groundPacket);
        }
        sendPacket(new VehicleMoveC2SPacket(boat));
        super.onEnable();
    }
}
