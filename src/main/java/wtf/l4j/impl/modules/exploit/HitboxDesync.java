package wtf.l4j.impl.modules.exploit;

import net.minecraft.util.math.*;
import wtf.l4j.api.event.GameTickListener;
import wtf.l4j.api.module.Category;
import wtf.l4j.api.module.Module;
import wtf.l4j.api.module.ModuleInfo;

@ModuleInfo(name = "HitBoxDeysnc", desc = "make op aura go funny", category = Category.EXPLOIT)
public class HitboxDesync extends Module implements GameTickListener {

    private static final double MAGIC_OFFSET = 0.200009968835369999878673424677777777777761;

    @Override
    public void onGameTick() {
        Direction facing = mc.player.getHorizontalFacing();
        Box boundingBox = mc.player.getBoundingBox();
        Vec3d center = boundingBox.getCenter();
        Vec3d offset = new Vec3d(facing.getUnitVector());

        Vec3d merged = merge(Vec3d.of(BlockPos.ofFloored(center)).add(.5, 0, .5).add(offset.multiply(MAGIC_OFFSET)), facing);
        mc.player.setPosition(merged.x == 0 ? mc.player.getX() : merged.x, mc.player.getY(), merged.z == 0 ? mc.player.getZ() : merged.z);
        toggle();
    }

    private Vec3d merge(Vec3d a, Direction facing) {
        return new Vec3d(a.x * Math.abs(facing.getUnitVector().x()), a.y * Math.abs(facing.getUnitVector().y()), a.z * Math.abs(facing.getUnitVector().z()));
    }
}
