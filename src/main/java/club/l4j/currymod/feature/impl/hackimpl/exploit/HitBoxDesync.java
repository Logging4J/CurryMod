package club.l4j.currymod.feature.impl.hackimpl.exploit;

import club.l4j.currymod.event.events.TickEvent;
import club.l4j.currymod.feature.core.Hack;
import demo.knight.demobus.event.DemoListen;
import net.minecraft.util.math.Box;
import net.minecraft.util.math.Direction;
import net.minecraft.util.math.Vec3d;

@Hack.Construct(name = "HitBoxDesync", description = "Russian exploit", category = Hack.Category.EXPLOITS)
public class HitBoxDesync extends Hack {

    public double offset = 0.200009968835369999878673424677777777777761;

    @DemoListen
    public void onTick(TickEvent e){
        if (nullCheck()) {return;}
        Direction facing = mc.player.getHorizontalFacing();
        Box boundingBox = mc.player.getBoundingBox();
        Vec3d center = boundingBox.getCenter();
        Vec3d offsetVec = new Vec3d(facing.getUnitVector());
        Vec3d finalPosition = merge(center.add(new Vec3d(0.5, 0, 0.5)).add(offsetVec.multiply(offset)), facing);
        double finalX = finalPosition.x == 0 ? mc.player.getX() : finalPosition.x;
        double finalZ = finalPosition.z == 0 ? mc.player.getZ() : finalPosition.z;
        mc.player.setPosition(finalX, mc.player.getY(), finalZ);
        toggle();
    }

    private Vec3d merge(Vec3d a, Direction facing) {
        return new Vec3d(a.x * Math.abs(facing.getUnitVector().x()), a.y * Math.abs(facing.getUnitVector().y()), a.z * Math.abs(facing.getUnitVector().z()));
    }



}
