package club.l4j.currymod.feature.impl.hackimpl.exploit;

import club.l4j.currymod.event.events.TickEvent;
import club.l4j.currymod.feature.core.Hack;
import club.l4j.currymod.feature.options.impl.OptionMode;
import demo.knight.demobus.event.DemoListen;
import net.minecraft.world.GameMode;

@Hack.Construct(name = "FakeGamemode", description = "Fake Gamemode", category = Hack.Category.EXPLOITS)
public class FakeGamemode extends Hack {

    OptionMode Gamemode = new OptionMode("Gamemode", "Creative", "Survival", "Spectator", "Adventure", "Creative");
    GameMode prevGamemode;

    public FakeGamemode() {
        addOptions(Gamemode);
    }

    @DemoListen
    public void onTick(TickEvent e) {
        if (mc.player == null) {
            return;
        }

        assert mc.interactionManager != null;
        prevGamemode = mc.interactionManager.getCurrentGameMode();

        String mode = Gamemode.getMode();
        GameMode gameMode = switch (mode) {
            case "Creative" -> GameMode.CREATIVE;
            case "Survival" -> GameMode.SURVIVAL;
            case "Spectator" -> GameMode.SPECTATOR;
            case "Adventure" -> GameMode.ADVENTURE;
            default -> null;
        };

        prevGamemode = mc.interactionManager.getCurrentGameMode();
        mc.interactionManager.setGameMode(gameMode);

    }

    @Override
    public void onDisable() {
        if (mc.player == null) {
            return;
        }

        assert mc.interactionManager != null;
        mc.interactionManager.setGameMode(prevGamemode);

        super.onDisable();
    }
}